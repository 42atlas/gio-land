{"version":3,"sources":["main.js"],"names":["kaboom","global","background","width","height","scale","canvas","document","getElementById","font","fullscreen","scaleMode","MAP_WIDTH","loadAseprite","loadSprite","loadSound","LEVELS","levelConf","pos","vec2","sprite","area","solid","origin","H","b","f","bump","c","cleanup","lifespan","fade","M","patrol","body","F","_","E","anim","tarma","A","ami","D","dito","state","Y","shark","speed","p","frame","mario","score","scene","add","text","size","color","onKeyRelease","go","time","setData","toFixed","levelNumber","layers","level","addLevel","music","play","volume","detune","rand","layer","fixed","timer","onUpdate","dt","scoreText","updateScore","points","directions","LEFT","RIGHT","current_direction","player","spawn","SPEED","BULLET_SPEED","onKeyDown","isFrozen","flipX","move","toScreen","x","onKeyPress","isAlive","isGrounded","jump","canSquash","grow","rate","update","n","y","addExplode","rad","i","wait","rect","outline","spawnBullet","sub","bulletSpeed","isFlamy","onCollide","e","destroy","killed","die","pause","toWorld","totscore","tottime","currCam","camPos","onFall","baddy","squash","shake","bigger","isBig","smaller","on","obj","is","coin","gridPos","box","mushy","flower","flamy","castle","side","freeze","nextLevel","length","s","distance","dir","id","require","startingPos","Math","abs","unuse","stop","use","offset","stopAtOrigin","bumpOffset","bumped","origPos","direction","smallAnimation","bigAnimation","flameanimation","smallStopFrame","bigStopFrame","flameStopFrame","smallJumpFrame","bigJumpFrame","flameJumpFrame","flameShotFrame","standing","isKeyDown","shooting","jumping","running","isShooting","animation","curAnim"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"..","sourcesContent":["kaboom({\r\n  global: true,\r\n\r\n  background: [134, 135, 247],\r\n  width: 320,\r\n  height: 240,\r\n  scale: 3,\r\n  canvas: document.getElementById(\"game\"),\r\n  font: \"sink\",\r\n  fullscreen: true,\r\n  scaleMode: \"stretch\",\r\n});\r\n\r\nconst MAP_WIDTH = 320;\r\n\r\n/* loadRoot(\"sprites/\"); */\r\nloadAseprite(\"mario\", \"Mario.png\", \"Mario.json\");\r\nloadAseprite(\"enemies\", \"enemies.png\", \"enemies.json\");\r\nloadSprite(\"ground\", \"ground.png\");\r\nloadSprite(\"questionBox\", \"questionBox.png\");\r\nloadSprite(\"emptyBox\", \"emptyBox.png\");\r\nloadSprite(\"brick\", \"brick.png\");\r\nloadSprite(\"coin\", \"coin.png\");\r\nloadSprite(\"bigMushy\", \"bigMushy.png\");\r\nloadSprite(\"Flower\", \"Flower.png\");\r\nloadSprite(\"pipeTop\", \"pipeTop.png\");\r\nloadSprite(\"pipeBottom\", \"pipeBottom.png\");\r\nloadSprite(\"shrubbery\", \"shrubbery.png\");\r\nloadSprite(\"hill\", \"hill.png\");\r\nloadSprite(\"cloud\", \"cloud.png\");\r\nloadSprite(\"castle\", \"castle.png\");\r\nloadSprite(\"noce\", \"noce.png\");\r\nloadSprite(\"racchetta\", \"racchetta.png\");\r\n\r\n/* loadRoot(\"sounds/\"); */\r\nloadSound(\"mushroom\", \"mushroom.wav\");\r\nloadSound(\"coin\", \"coin.wav\");\r\nloadSound(\"flower\", \"flower.wav\");\r\nloadSound(\"jump\", \"jump.wav\");\r\nloadSound(\"hit\", \"hit.wav\");\r\nloadSound(\"gameover\", \"gameover.wav\");\r\nloadSound(\"stageclear\", \"stageclear.wav\");\r\nloadSound(\"goodbox\", \"goodbox.wav\");\r\nloadSound(\"getsmall\", \"getsmall.wav\");\r\nloadSound(\"flower-chomp\", \"flower-chomp.mp3\");\r\nloadSound(\"noce\", \"noce.wav\");\r\n\r\n//soundtrack\r\nloadSound(\"level0\", \"level0.mp3\");\r\nloadSound(\"level1\", \"level1.mp3\");\r\nloadSound(\"level2\", \"level2.mp3\");\r\nloadSound(\"level3\", \"level3.mp3\");\r\n\r\nconst LEVELS = [\r\n  [\r\n    \"                                                                                                                                                                                                           \",\r\n    \"                                                                                                                                                                                                           \",\r\n    \"                                                                                                                                                                                                           \",\r\n    \"                                                                                                                                                                                                           \",\r\n    \"                                                                                                                                                                                                           \",\r\n    \"                                                                                                                                                                                                           \",\r\n    \"                                                                                                                                       ?                                                                   \",\r\n    \"      -?-b-                 ?-                                                  -??-                                   ?                                                                                   \",\r\n    \"                                                      ?          ?                                ?                                                                                                        \",\r\n    \"                                                             ?                                               -f-  ?                                               ---      ???   ---                       \",\r\n    \"                                                 -                                                                                               _                                                         \",\r\n    \"                                   _                                                                                                _     _      |                                                         \",\r\n    \"                       _           |    _                _               _                                                  _       |     |      |             -                                           \",\r\n    \"                E      |           |    |      E   E     |           E   |              A     _         _   A               |       |     |      |             |          E E E E                 H        \",\r\n    \"=================================================================================================  ===========================   =====   ===   ============================================================\",\r\n    \"=================================================================================================  ===========================   =====   ===   ============================================================\",\r\n  ],\r\n  [\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                         ?                                                                                   -?-                                                                            \",\r\n    \"                                                                   f                                                                                                                                        \",\r\n    \"                                   -?-                                                                                                                  ?                                                   \",\r\n    \"                                                                                                               -?-                                                                                          \",\r\n    \"      -?-b-                  -?-                                                                   b                               E                                                                        \",\r\n    \"                                                                                                                                  -?-                                ---                                    \",\r\n    \"                                                                                 -?-                                E                                                                                       \",\r\n    \"                                                           -                                                       -?-                                                                                      \",\r\n    \"                                                           |                              -                                                                                                                 \",\r\n    \"       _                                            _      |                              |                                     _                                                                           \",\r\n    \"       |                            A               |      |    E    E                    |          A           A   _          | A          A             E              A                       H         \",\r\n    \"================     =========================================================     ======================================    ===============================================================================\",\r\n    \"================     =========================================================     ======================================    ===============================================================================\",\r\n  ],\r\n  [\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                       ?                                                                                                                                                                    \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                   -?-             -?-         -?-          -?-                                                                                                                             \",\r\n    \"                                                                                                                                                                                ?      ?                    \",\r\n    \"      -?-f-                  -b-                                                         ---?--?--?--?                                                                        ?                             \",\r\n    \"                                                                                                                                          ?-f-?                                                             \",\r\n    \"                                                                                                                          ?-                                                                                \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                             Y           Y            Y                   Y                Y       Y       Y                                                                                                \",\r\n    \"       _                     _           _            _        _          _                _       _       _                         _                                                                      \",\r\n    \"       |                     |    E      |    A       |        |    A     |     A          |       |       |   E                     |                              D                             H         \",\r\n    \"================     ====================================     =======================================================   =======   ==========================================================================\",\r\n    \"================     ====================================     =======================================================   =======   ==========================================================================\",\r\n  ],\r\n  [\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                               ????????????????????????????????????                                                                                                                         \",\r\n    \"                                   -?-                                                                                                                                                                      \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"      -?-b-                  -?-                                                         -f-                                              --?-                                                              \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                                                                                                            \",\r\n    \"                                                                                                                      _                                                                                     \",\r\n    \"                                                                                                         _            |                                      _                                              \",\r\n    \"       _               _                                              _          _                       |            |                  _                   |                                              \",\r\n    \"       |               |          E  E  E  EE  E   D   A    A    A    |     D    |                       |            |         D        |        D          |        D                           H         \",\r\n    \"================     ================================================================  ==========    =========   ===========================================================================================\",\r\n    \"================     ================================================================  ==========    =========   ===========================================================================================\",\r\n  ],\r\n];\r\n\r\nconst levelConf = {\r\n  // grid size\r\n  width: 16,\r\n  height: 16,\r\n  pos: vec2(0, 0),\r\n  // define each object as a list of components\r\n  \"=\": () => [\r\n    sprite(\"ground\"),\r\n    area(),\r\n    solid(),\r\n    origin(\"bot\"),\r\n    \"ground\",\r\n    \"wall\",\r\n  ],\r\n  \"-\": () => [sprite(\"brick\"), area(), solid(), origin(\"bot\"), \"brick\", \"wall\"],\r\n  H: () => [\r\n    sprite(\"castle\"),\r\n    area({ width: 1, height: 240 }),\r\n\r\n    origin(\"bot\"),\r\n    \"castle\",\r\n  ],\r\n  \"?\": () => [\r\n    sprite(\"questionBox\"),\r\n    area(),\r\n    solid(),\r\n    origin(\"bot\"),\r\n    \"questionBox\",\r\n    \"coinBox\",\r\n    \"wall\",\r\n  ],\r\n  b: () => [\r\n    sprite(\"questionBox\"),\r\n    area(),\r\n    solid(),\r\n    origin(\"bot\"),\r\n    \"questionBox\",\r\n    \"mushyBox\",\r\n    \"wall\",\r\n  ],\r\n  f: () => [\r\n    sprite(\"questionBox\"),\r\n    area(),\r\n    solid(),\r\n    origin(\"bot\"),\r\n    \"questionBox\",\r\n    \"flowerBox\",\r\n    \"wall\",\r\n  ],\r\n  \"!\": () => [\r\n    sprite(\"emptyBox\"),\r\n    area(),\r\n    solid(),\r\n    bump(),\r\n    origin(\"bot\"),\r\n    \"emptyBox\",\r\n    \"wall\",\r\n  ],\r\n  c: () => [\r\n    sprite(\"coin\"),\r\n    area(),\r\n    solid(),\r\n    bump(64, 8),\r\n    cleanup(),\r\n    lifespan(1, { fade: 0.5 }),\r\n    origin(\"bot\"),\r\n    \"coin\",\r\n  ],\r\n  M: () => [\r\n    sprite(\"bigMushy\"),\r\n    area(),\r\n    solid(),\r\n    patrol(10000),\r\n    body(),\r\n    cleanup(),\r\n    origin(\"bot\"),\r\n    \"bigMushy\",\r\n  ],\r\n  F: () => [\r\n    sprite(\"Flower\"),\r\n    area(),\r\n    solid(),\r\n    body(),\r\n    cleanup(),\r\n    origin(\"bot\"),\r\n    \"Flower\",\r\n  ],\r\n  \"|\": () => [\r\n    sprite(\"pipeBottom\"),\r\n    area(),\r\n    solid(),\r\n    origin(\"bot\"),\r\n    \"pipe\",\r\n    \"wall\",\r\n  ],\r\n  _: () => [sprite(\"pipeTop\"), area(), solid(), origin(\"bot\"), \"pipe\", \"wall\"],\r\n  E: () => [\r\n    sprite(\"enemies\", { anim: \"Walking\" }),\r\n    area({ width: 20, height: 24 }),\r\n    solid(),\r\n    body(),\r\n    patrol(50),\r\n    tarma(),\r\n    origin(\"bot\"),\r\n    \"badGuy\",\r\n    \"enemy\",\r\n  ],\r\n  A: () => [\r\n    sprite(\"enemies\", { anim: \"Walk\" }),\r\n    area({ width: 26, height: 20 }),\r\n    solid(),\r\n    body(),\r\n    patrol(100),\r\n    ami(),\r\n    origin(\"bot\"),\r\n    \"badGuy\",\r\n    \"enemy\",\r\n  ],\r\n  D: () => [\r\n    sprite(\"enemies\", { anim: \"WalkHB\" }),\r\n    area({ width: 20, height: 28 }),\r\n    solid(),\r\n    body(),\r\n    patrol(30),\r\n    dito(),\r\n    state(\"move\", [\"idle\", \"attack\", \"move\"]),\r\n    origin(\"bot\"),\r\n    \"badGuy\",\r\n    \"enemy\",\r\n    \"dito\",\r\n  ],\r\n  Y: () => [\r\n    sprite(\"enemies\", { anim: \"Piranha\" }),\r\n    area({ width: 20, height: 28 }),\r\n    /* solid(), */\r\n    /* body(), */\r\n    shark(),\r\n    origin(\"top\"),\r\n    \"shark\",\r\n    \"badGuyShark\",\r\n    \"enemy\",\r\n    {\r\n      speed: 20,\r\n    },\r\n  ],\r\n  p: () => [\r\n    sprite(\"mario\", { frame: 0 }),\r\n    area({ width: 16, height: 16 }),\r\n    body(),\r\n    mario(),\r\n    bump(150, 20, false),\r\n    origin(\"bot\"),\r\n    \"player\",\r\n    {\r\n      score: 0,\r\n    },\r\n  ],\r\n};\r\n\r\n//scene START\r\n\r\nscene(\"start\", () => {\r\n  add([\r\n    text(\"Press enter to play\", { size: 10 }),\r\n    pos(160, 100),\r\n    origin(\"center\"),\r\n    color(255, 255, 255),\r\n  ]);\r\n  add([\r\n    text(\"Use the arrows to move\", { size: 8 }),\r\n    pos(160, 140),\r\n    origin(\"center\"),\r\n    color(255, 255, 255),\r\n  ]);\r\n  add([\r\n    text(\"and the spacebar eventually\", { size: 8 }),\r\n    pos(160, 150),\r\n    origin(\"center\"),\r\n    color(255, 255, 255),\r\n  ]);\r\n\r\n  onKeyRelease(\"enter\", () => {\r\n    go(\"game\");\r\n  });\r\n  /* onClick(() => go(\"game\")); */\r\n});\r\n\r\ngo(\"start\");\r\n\r\n//scene LOSE\r\n\r\nscene(\"lose\", (score, time) => {\r\n  add([\r\n    sprite(\"mario\", { frame: 6 }),\r\n    pos(width() / 2, height() / 2 - 100),\r\n    scale(2),\r\n    origin(\"center\"),\r\n  ]);\r\n\r\n  // display score\r\n  add([\r\n    text(`Score:${score}`, { size: 8, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 - 40),\r\n    scale(2),\r\n    origin(\"center\"),\r\n    setData(\"score\", score),\r\n  ]);\r\n\r\n  // display time\r\n  add([\r\n    text(`Time:${time.toFixed(2)}`, { size: 8, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 - 10),\r\n    scale(2),\r\n    origin(\"center\"),\r\n    setData(\"time\", time.toFixed(2)),\r\n  ]);\r\n\r\n  add([\r\n    text(`Press enter to play again`, { size: 6, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 - 60),\r\n    scale(2),\r\n    origin(\"center\"),\r\n    setData(\"time\", time.toFixed(2)),\r\n  ]);\r\n\r\n  onKeyRelease(\"enter\", () => go(\"game\"));\r\n\r\n  //highscore\r\n  /*   \r\n  add([\r\n    text(`Insert name to record highscore:`, { size: 5, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 + 20),\r\n    scale(2),\r\n    origin(\"center\"),\r\n  ]);\r\n\r\n  const input = add([\r\n    text(\"click me and write\", { size: 8, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 + 40),\r\n    scale(2),\r\n    origin(\"center\"),\r\n  ]);\r\n\r\n\r\n  addButton(\"Send\", vec2(width() / 2, height() / 2 + 60), () => {\r\n    setData(\"name\", input.text);\r\n    debug.log(\"Yea, check the highscore under the game!\");\r\n  });\r\n  addButton(\"Start Again\", vec2(width() / 2, height() / 2 + 80), () =>\r\n    go(\"game\")\r\n  );\r\n\r\n  onCharInput((ch) => {\r\n    input.text += ch;\r\n  });\r\n\r\n  onKeyPressRepeat(\"backspace\", () => {\r\n    input.text = input.text.substring(0, input.text.length - 1);\r\n  }); */\r\n\r\n  /*  onKeyPress(\"enter\", () => go(\"game\")); */\r\n\r\n  //buttons function\r\n\r\n  /* function addButton(txt, p, f) {\r\n    const btn = add([\r\n      text(txt),\r\n      pos(p),\r\n      area({ cursor: \"pointer\" }),\r\n      scale(1),\r\n      origin(\"center\"),\r\n    ]);\r\n\r\n    btn.onClick(f);\r\n\r\n    btn.onUpdate(() => {\r\n      if (btn.isHovering()) {\r\n        const t = rand(10) * 10;\r\n        btn.color = rgb(\r\n          wave(0, 255, t),\r\n          wave(0, 255, t + 2),\r\n          wave(0, 255, t + 4)\r\n        );\r\n        btn.scale = vec2(1.2);\r\n      } else {\r\n        btn.scale = vec2(1);\r\n        btn.color = rgb();\r\n      }\r\n    });\r\n  }\r\n\r\n  onUpdate(() => cursor(\"default\")); */\r\n});\r\n\r\n//scene WIN\r\n\r\nscene(\"win\", (score, time) => {\r\n  add([\r\n    text(`YOU WON!`),\r\n    pos(width() / 2, height() / 2 - 120),\r\n    scale(2),\r\n    origin(\"center\"),\r\n  ]);\r\n  add([\r\n    sprite(\"mario\", { frame: 13 }),\r\n    pos(width() / 2, height() / 2 - 100),\r\n    scale(2),\r\n    origin(\"center\"),\r\n  ]);\r\n\r\n  add([\r\n    text(`Score:${score}`, { size: 8, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 - 40),\r\n    scale(2),\r\n    origin(\"center\"),\r\n    setData(\"score\", score),\r\n  ]);\r\n\r\n  // display time\r\n  add([\r\n    text(`Time:${time.toFixed(2)}`, { size: 8, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 - 10),\r\n    scale(2),\r\n    origin(\"center\"),\r\n    setData(\"time\", time.toFixed(2)),\r\n  ]);\r\n\r\n  add([\r\n    text(`Press enter to play again`, { size: 6, font: \"sink\" }),\r\n    pos(width() / 2, height() / 2 - 60),\r\n    scale(2),\r\n    origin(\"center\"),\r\n    setData(\"time\", time.toFixed(2)),\r\n  ]);\r\n\r\n  onKeyRelease(\"enter\", () => go(\"game\"));\r\n});\r\n\r\n//scene GAME\r\n\r\nscene(\"game\", (levelNumber = 0, score = 0, time = 0) => {\r\n  layers([\"bg\", \"game\", \"ui\"], \"game\");\r\n\r\n  /* gravity(2200); */\r\n\r\n  const level = addLevel(LEVELS[levelNumber], levelConf);\r\n\r\n  const music = play(`level${levelNumber}`, {\r\n    volume: 0.2,\r\n    detune: rand(0, 0),\r\n  });\r\n\r\n  music.play();\r\n\r\n  add([sprite(\"cloud\"), pos(20, 50), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(150, 60), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(320, 40), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(520, 50), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(620, 70), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(820, 40), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(1020, 70), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(1190, 50), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(1300, 80), layer(\"bg\")]);\r\n  add([sprite(\"cloud\"), pos(1420, 60), layer(\"bg\")]);\r\n\r\n  add([sprite(\"hill\"), pos(32, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"hill\"), pos(409, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"hill\"), pos(803, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"hill\"), pos(1200, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"hill\"), pos(1500, 208), layer(\"bg\"), origin(\"bot\")]);\r\n\r\n  add([sprite(\"shrubbery\"), pos(200, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"shrubbery\"), pos(680, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"shrubbery\"), pos(480, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"shrubbery\"), pos(1080, 208), layer(\"bg\"), origin(\"bot\")]);\r\n  add([sprite(\"shrubbery\"), pos(1250, 208), layer(\"bg\"), origin(\"bot\")]);\r\n\r\n  add([\r\n    text(\"Level \" + (levelNumber + 1), { size: 18 }),\r\n    pos(vec2(160, 120)),\r\n    color(255, 255, 255),\r\n    origin(\"center\"),\r\n    layer(\"ui\"),\r\n    lifespan(1, { fade: 0.5 }),\r\n  ]);\r\n\r\n  //timer\r\n  add([\r\n    text(\"TIME: \", { size: 8, font: \"sink\" }),\r\n    pos(20, 10),\r\n    origin(\"center\"),\r\n    layer(\"ui\"),\r\n    fixed(),\r\n  ]);\r\n\r\n  const timer = add([\r\n    text(time, { size: 8, font: \"sink\" }),\r\n    pos(50, 10),\r\n    fixed(),\r\n    { time: 0 },\r\n    origin(\"center\"),\r\n    layer(\"ui\"),\r\n  ]);\r\n\r\n  timer.onUpdate(() => {\r\n    time += dt();\r\n    timer.text = time.toFixed(2);\r\n  });\r\n\r\n  //score\r\n\r\n  add([\r\n    text(\"SCORE: \", { size: 8, font: \"sink\" }),\r\n    pos(140, 10),\r\n    origin(\"center\"),\r\n    layer(\"ui\"),\r\n    fixed(),\r\n  ]);\r\n\r\n  const scoreText = add([\r\n    text(score, { size: 8, font: \"sink\" }),\r\n    pos(170, 10),\r\n    origin(\"center\"),\r\n    layer(\"ui\"),\r\n    fixed(),\r\n  ]);\r\n\r\n  function updateScore(points) {\r\n    score += points;\r\n    scoreText.text = score;\r\n  }\r\n\r\n  //directions\r\n\r\n  const directions = {\r\n    LEFT: \"left\",\r\n    RIGHT: \"right\",\r\n  };\r\n\r\n  let current_direction = directions.RIGHT;\r\n\r\n  //player\r\n\r\n  const player = level.spawn(\"p\", 1, 10);\r\n\r\n  const SPEED = 100;\r\n  const BULLET_SPEED = 200;\r\n\r\n  onKeyDown(\"right\", () => {\r\n    current_direction = directions.RIGHT;\r\n    if (player.isFrozen) return;\r\n    player.flipX(false);\r\n    player.move(SPEED, 0);\r\n  });\r\n\r\n  onKeyDown(\"left\", () => {\r\n    current_direction = directions.LEFT;\r\n    if (player.isFrozen) return;\r\n    player.flipX(true);\r\n    if (toScreen(player.pos).x > 20) {\r\n      player.move(-SPEED, 0);\r\n    }\r\n  });\r\n\r\n  onKeyPress(\"up\", () => {\r\n    if (player.isAlive && player.isGrounded()) {\r\n      player.jump(600);\r\n      canSquash = true;\r\n    }\r\n    play(\"jump\", {\r\n      volume: 0.05,\r\n      detune: rand(-200, 0),\r\n    });\r\n  });\r\n\r\n  //grow\r\n\r\n  function grow(rate) {\r\n    return {\r\n      update() {\r\n        const n = rate * dt();\r\n        this.scale.x += n;\r\n        this.scale.y += n;\r\n      },\r\n    };\r\n  }\r\n\r\n  // explode\r\n\r\n  function addExplode(p, n, rad, size) {\r\n    for (let i = 0; i < n; i++) {\r\n      wait(rand(n * 0.1), () => {\r\n        for (let i = 0; i < 2; i++) {\r\n          add([\r\n            pos(/* p.add(rand(vec2(-rad), vec2(rad))) */ p),\r\n            rect(4, 4),\r\n            outline(4),\r\n            scale(1 * size, 1 * size),\r\n            lifespan(0.1),\r\n            grow(rand(10, 10) * size),\r\n            origin(\"center\"),\r\n          ]);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  //shooting gio\r\n\r\n  function spawnBullet(p) {\r\n    if (current_direction == directions.LEFT) {\r\n      p = p.sub(10, 0);\r\n    } else if (current_direction == directions.RIGHT) {\r\n      p = p.add(10, 0);\r\n    }\r\n    add([\r\n      sprite(\"noce\"),\r\n      area(),\r\n      pos(p),\r\n      origin(\"center\"),\r\n      /* move(RIGHT, BULLET_SPEED), */\r\n      cleanup(),\r\n      \"bullet\",\r\n      {\r\n        bulletSpeed:\r\n          current_direction == directions.LEFT\r\n            ? -1 * BULLET_SPEED\r\n            : BULLET_SPEED,\r\n      },\r\n    ]);\r\n  }\r\n\r\n  onUpdate(\"bullet\", (b) => {\r\n    b.move(b.bulletSpeed, 0);\r\n    /* if (b.pos.x < 0 || b.pos.x > MAP_WIDTH) {\r\n      destroy(b);\r\n    } */\r\n  });\r\n\r\n  onKeyPress(\"space\", () => {\r\n    if (player.isFlamy) {\r\n      spawnBullet(player.pos.sub(-4, 10));\r\n      /* spawnBullet(player.pos.add(3, 0)); */\r\n      play(\"noce\", {\r\n        volume: 0.1,\r\n        detune: rand(-1200, 1200),\r\n      });\r\n    }\r\n    wait(0.2),\r\n      () => {\r\n        return;\r\n      };\r\n  });\r\n\r\n  onCollide(\"bullet\", \"enemy\", (b, e) => {\r\n    destroy(b);\r\n    destroy(e);\r\n    addExplode(b.pos, 1, 24, 1);\r\n  });\r\n\r\n  onCollide(\"bullet\", \"wall\", (b, e) => {\r\n    destroy(b);\r\n\r\n    addExplode(b.pos, 1, 24, 1);\r\n  });\r\n\r\n  //shooting dito\r\n\r\n  /*   const dito = get(\"dito\");\r\n\r\n  function spawnRachet() {\r\n    if (player.exists()) {\r\n      const dir = player.pos.sub(dito.pos).unit();\r\n      add([\r\n        sprite(\"racchetta\"),\r\n        area(),\r\n        pos(dito.pos),\r\n        origin(\"center\"),\r\n        move(dir, BULLET_SPEED),\r\n        cleanup(),\r\n        \"rachet\",\r\n      ]);\r\n    }\r\n  }\r\n\r\n  onUpdate(\"rachet\", (b) => {\r\n    b.move(b.bulletSpeed, 0);\r\n   \r\n  });\r\n\r\n  onUpdate(\"dito\", (d) => {\r\n    spawnRachet(d.pos.sub(-4, 10));\r\n    \r\n    play(\"noce\", {\r\n      volume: 0.1,\r\n      detune: rand(-1200, 1200),\r\n    });\r\n  });\r\n\r\n  onCollide(\"rachet\", player, (b, e) => {\r\n    destroy(b);\r\n    killed();\r\n    addExplode(b.pos, 1, 24, 1);\r\n  });\r\n\r\n  onCollide(\"rachet\", \"wall\", (b, e) => {\r\n    destroy(b);\r\n\r\n    addExplode(b.pos, 1, 24, 1);\r\n  }); */\r\n\r\n  //////////////////////////////\r\n\r\n  /*   const _dito = get(\"dito\");\r\n\r\n  const DITO_SPEED = 160;\r\n\r\n  _dito.onStateEnter(\"idle\", async () => {\r\n    await wait(0.5);\r\n    _dito.enterState(\"attack\");\r\n  });\r\n  +_dito.onStateEnter(\"attack\", async () => {\r\n    // Don't do anything if player doesn't exist anymore\r\n    if (player.exists()) {\r\n      const dir = player.pos.sub(dito.pos).unit();\r\n\r\n      add([\r\n        pos(dito.pos),\r\n        move(dir, BULLET_SPEED),\r\n        sprite(\"racchetta\"),\r\n        area(),\r\n        cleanup(),\r\n        origin(\"center\"),\r\n\r\n        \"rachet\",\r\n      ]);\r\n    }\r\n\r\n    await wait(1);\r\n    dito.enterState(\"move\");\r\n  });\r\n\r\n  _dito.onStateEnter(\"move\", async () => {\r\n    await wait(2);\r\n    _dito.enterState(\"idle\");\r\n  });\r\n\r\n  // Like .onUpdate() which runs every frame, but only runs when the current state is \"move\"\r\n  // Here we move towards the player every frame if the current state is \"move\"\r\n  _dito.onStateUpdate(\"move\", () => {\r\n    if (!player.exists()) return;\r\n    const dir = player.pos.sub(_dito.pos).unit();\r\n    _dito.move(dir.scale(DITO_SPEED));\r\n  });\r\n\r\n  // Have to manually call enterState() to trigger the onStateEnter(\"move\") event we defined above.\r\n  _dito.enterState(\"move\");\r\n\r\n  // Taking a bullet makes us disappear\r\n  player.onCollide(\"rachet\", (bullet) => {\r\n    destroy(bullet);\r\n    killed();\r\n    addKaboom(bullet.pos);\r\n  }); */\r\n\r\n  //Killed\r\n\r\n  function killed() {\r\n    // is dead :(\r\n    if (player.isAlive == false) return; // Don't run it if mario is already dead\r\n    player.die();\r\n    music.pause();\r\n    add([\r\n      text(\"Gio is dead :(\", { size: 24 }),\r\n      pos(toWorld(vec2(160, 120))),\r\n      color(255, 255, 255),\r\n      origin(\"center\"),\r\n      layer(\"ui\"),\r\n    ]);\r\n    wait(3, () => {\r\n      let totscore = score;\r\n      let tottime = time;\r\n      go(\"lose\", totscore, tottime);\r\n    });\r\n  }\r\n\r\n  // camera settings\r\n\r\n  player.onUpdate(() => {\r\n    // center camera to player\r\n    var currCam = camPos();\r\n    if (currCam.x < player.pos.x) {\r\n      camPos(player.pos.x, currCam.y);\r\n    }\r\n\r\n    if (player.isAlive && player.isGrounded()) {\r\n      canSquash = false;\r\n    }\r\n\r\n    // Check if Mario has fallen off the screen\r\n    if (player.pos.y > height() - 16) {\r\n      killed();\r\n    }\r\n  });\r\n\r\n  //collision with badguys\r\n\r\n  let canSquash = false;\r\n\r\n  player.onFall(() => {\r\n    canSquash = true;\r\n  });\r\n\r\n  player.onCollide(\"badGuy\", (baddy) => {\r\n    if (baddy.isAlive == false) return;\r\n    if (player.isAlive == false) return;\r\n    if (canSquash) {\r\n      // Mario has jumped on the bad guy:\r\n      baddy.squash();\r\n      play(\"hit\", {\r\n        volume: 0.2,\r\n        detune: rand(-100, 0),\r\n      });\r\n    } else {\r\n      // Mario has been hurt\r\n      if (player.isFlamy) {\r\n        shake(10);\r\n        wait(0.25, () => {\r\n          player.bigger();\r\n          play(\"getsmall\", {\r\n            volume: 0.2,\r\n            detune: rand(-100, 0),\r\n          });\r\n        });\r\n      } else if (player.isBig) {\r\n        shake(10);\r\n        wait(0.25, () => {\r\n          player.smaller();\r\n          play(\"getsmall\", {\r\n            volume: 0.2,\r\n            detune: rand(-100, 0),\r\n          });\r\n        });\r\n      } else {\r\n        // Mario is dead :(\r\n        shake(10);\r\n        killed();\r\n      }\r\n    }\r\n  });\r\n\r\n  player.onCollide(\"badGuyShark\", (baddy) => {\r\n    if (baddy.isAlive == false) return;\r\n    if (player.isAlive == false) return;\r\n    // Mario has been hurt\r\n    if (player.isFlamy) {\r\n      shake(10);\r\n      wait(0.25, () => {\r\n        player.bigger();\r\n        play(\"getsmall\", {\r\n          volume: 0.2,\r\n          detune: rand(-100, 0),\r\n        });\r\n      });\r\n    } else if (player.isBig) {\r\n      shake(10);\r\n      wait(0.25, () => {\r\n        player.smaller();\r\n        play(\"getsmall\", {\r\n          volume: 0.2,\r\n          detune: rand(-100, 0),\r\n        });\r\n      });\r\n    } else {\r\n      // Mario is dead :(\r\n      shake(10);\r\n      killed();\r\n    }\r\n  });\r\n\r\n  //headbutt\r\n\r\n  player.on(\"headbutt\", (obj) => {\r\n    if (obj.is(\"questionBox\")) {\r\n      if (obj.is(\"coinBox\")) {\r\n        let coin = level.spawn(\"c\", obj.gridPos.sub(0, 1));\r\n        coin.bump();\r\n        updateScore(5);\r\n        play(\"coin\", {\r\n          volume: 0.2,\r\n          detune: rand(-400, 100),\r\n        });\r\n      } else if (obj.is(\"mushyBox\")) {\r\n        level.spawn(\"M\", obj.gridPos.sub(0, 1));\r\n        play(\"goodbox\", {\r\n          volume: 0.7,\r\n          detune: rand(-400, 100),\r\n        });\r\n      } else if (obj.is(\"flowerBox\")) {\r\n        level.spawn(\"F\", obj.gridPos.sub(0, 1));\r\n        play(\"goodbox\", {\r\n          volume: 0.7,\r\n          detune: rand(-400, 100),\r\n        });\r\n      }\r\n      var pos = obj.gridPos;\r\n      destroy(obj);\r\n      var box = level.spawn(\"!\", pos);\r\n      box.bump();\r\n    }\r\n  });\r\n\r\n  //fungo & fiore\r\n\r\n  player.onCollide(\"bigMushy\", (mushy) => {\r\n    destroy(mushy);\r\n    player.bigger();\r\n    play(\"mushroom\", {\r\n      volume: 0.2,\r\n      detune: rand(-400, 100),\r\n    });\r\n  });\r\n\r\n  player.onCollide(\"Flower\", (flower) => {\r\n    destroy(flower);\r\n    player.flamy();\r\n    play(\"flower\", {\r\n      volume: 0.2,\r\n      detune: rand(-400, 100),\r\n    });\r\n  });\r\n\r\n  //castle\r\n\r\n  player.onCollide(\"castle\", (castle, side) => {\r\n    player.freeze();\r\n    music.pause();\r\n    play(\"stageclear\", {\r\n      volume: 0.2,\r\n      detune: rand(-200, 100),\r\n    });\r\n    add([\r\n      text(\"Good Giob!\", { size: 24 }),\r\n      pos(toWorld(vec2(160, 120))),\r\n      color(255, 255, 255),\r\n      origin(\"center\"),\r\n      layer(\"ui\"),\r\n    ]);\r\n    wait(7, () => {\r\n      let nextLevel = levelNumber + 1;\r\n      let totscore = score;\r\n      let tottime = time;\r\n\r\n      if (nextLevel >= LEVELS.length) {\r\n        go(\"win\", totscore, tottime);\r\n      } else {\r\n        go(\"game\", nextLevel, totscore, tottime);\r\n      }\r\n    });\r\n  });\r\n\r\n  //shark move\r\n\r\n  onUpdate(\"shark\", (s) => {\r\n    s.move(0, -s.speed);\r\n\r\n    if (s.pos.y > 200 || s.pos.y < 150) {\r\n      s.speed = s.speed * -1;\r\n    }\r\n  });\r\n});\r\n\r\n//patrol function\r\n\r\nfunction patrol(distance = 100, speed = 50, dir = 1) {\r\n  return {\r\n    id: \"patrol\",\r\n    require: [\"pos\", \"area\"],\r\n    startingPos: vec2(0, 0),\r\n    add() {\r\n      this.startingPos = this.pos;\r\n      this.onCollide(\"badGuy\", () => {\r\n        dir = -dir;\r\n      });\r\n      this.onCollide(\"pipe\", () => {\r\n        dir = -dir;\r\n      });\r\n    },\r\n    update() {\r\n      if (Math.abs(this.pos.x - this.startingPos.x) >= distance) {\r\n        dir = -dir;\r\n      }\r\n      this.move(speed * dir, 0);\r\n    },\r\n  };\r\n}\r\n\r\n//enemies set\r\n\r\nfunction tarma() {\r\n  return {\r\n    id: \"tarma\",\r\n    require: [\"pos\", \"area\", \"sprite\", \"patrol\"],\r\n    isAlive: true,\r\n    update() {},\r\n    squash() {\r\n      this.isAlive = false;\r\n      this.unuse(\"patrol\");\r\n      this.stop();\r\n      this.frame = 2;\r\n      this.area.width = 18;\r\n      this.area.height = 8;\r\n      this.use(lifespan(0.5, { fade: 0.1 }));\r\n    },\r\n  };\r\n}\r\n\r\nfunction ami() {\r\n  return {\r\n    id: \"ami\",\r\n    require: [\"pos\", \"area\", \"sprite\", \"patrol\"],\r\n    isAlive: true,\r\n    update() {},\r\n    squash() {\r\n      this.isAlive = false;\r\n      this.unuse(\"patrol\");\r\n      this.stop();\r\n      this.frame = 5;\r\n      this.area.width = 26;\r\n      this.area.height = 18;\r\n      this.use(lifespan(0.5, { fade: 0.1 }));\r\n    },\r\n  };\r\n}\r\n\r\nfunction dito() {\r\n  return {\r\n    id: \"dito\",\r\n    require: [\"pos\", \"area\", \"sprite\", \"patrol\", \"state\"],\r\n    isAlive: true,\r\n\r\n    update() {},\r\n    squash() {\r\n      this.isAlive = false;\r\n      this.unuse(\"patrol\");\r\n      this.stop();\r\n      this.frame = 12;\r\n      this.area.width = 20;\r\n      this.area.height = 22;\r\n      this.use(lifespan(0.5, { fade: 0.1 }));\r\n    },\r\n  };\r\n}\r\n\r\nfunction shark() {\r\n  return {\r\n    id: \"shark\",\r\n    require: [\"pos\", \"area\", \"sprite\"],\r\n    isAlive: true,\r\n    update() {},\r\n    squash() {\r\n      this.isAlive = false;\r\n      this.unuse(\"patrol\");\r\n      this.stop();\r\n      this.frame = 12;\r\n      this.area.width = 20;\r\n      this.area.height = 22;\r\n      this.use(lifespan(0.5, { fade: 0.1 }));\r\n    },\r\n  };\r\n}\r\n\r\n//general bump\r\n\r\nfunction bump(offset = 8, speed = 2, stopAtOrigin = true) {\r\n  return {\r\n    id: \"bump\",\r\n    require: [\"pos\"],\r\n    bumpOffset: offset,\r\n    speed: speed,\r\n    bumped: false,\r\n    origPos: 0,\r\n    direction: -1,\r\n    update() {\r\n      if (this.bumped) {\r\n        this.pos.y = this.pos.y + this.direction * this.speed;\r\n        if (this.pos.y < this.origPos - this.bumpOffset) {\r\n          this.direction = 1;\r\n        }\r\n        if (stopAtOrigin && this.pos.y >= this.origPos) {\r\n          this.bumped = false;\r\n          this.pos.y = this.origPos;\r\n          this.direction = -1;\r\n        }\r\n      }\r\n    },\r\n    bump() {\r\n      this.bumped = true;\r\n      this.origPos = this.pos.y;\r\n    },\r\n  };\r\n}\r\n\r\n//GIO\r\nfunction mario() {\r\n  return {\r\n    id: \"mario\",\r\n    require: [\"body\", \"area\", \"sprite\", \"bump\"],\r\n    smallAnimation: \"Running\",\r\n    bigAnimation: \"RunningBig\",\r\n    flameanimation: \"Loop\",\r\n    smallStopFrame: 0,\r\n    bigStopFrame: 8,\r\n    flameStopFrame: 17,\r\n    smallJumpFrame: 5,\r\n    bigJumpFrame: 13,\r\n    flameJumpFrame: 22,\r\n    flameShotFrame: 25,\r\n    /* smallDieFrame: 6, */\r\n    isBig: false,\r\n    isFrozen: false,\r\n    isFlamy: false,\r\n    isAlive: true,\r\n    update() {\r\n      if (this.isFrozen) {\r\n        this.standing();\r\n        return;\r\n      }\r\n\r\n      if (this.isFlamy && isKeyDown(\"space\")) {\r\n        this.shooting();\r\n        return;\r\n      }\r\n\r\n      if (!this.isGrounded()) {\r\n        this.jumping();\r\n      } else {\r\n        if (isKeyDown(\"left\") || isKeyDown(\"right\")) {\r\n          this.running();\r\n        } else {\r\n          this.standing();\r\n        }\r\n      }\r\n    },\r\n    bigger() {\r\n      this.isBig = true;\r\n      this.isFlamy = false;\r\n      this.area.width = 20;\r\n      this.area.height = 22;\r\n    },\r\n    flamy() {\r\n      this.isShooting = false;\r\n      this.isBig = false;\r\n      this.isFlamy = true;\r\n      this.area.width = 20;\r\n      this.area.height = 22;\r\n    },\r\n    smaller() {\r\n      this.isBig = false;\r\n      this.isFlamy = false;\r\n      this.area.width = 16;\r\n      this.area.height = 16;\r\n    },\r\n    standing() {\r\n      this.stop();\r\n      if (this.isBig) {\r\n        this.frame = this.bigStopFrame;\r\n      } else if (this.isFlamy) {\r\n        this.frame = this.flameStopFrame;\r\n      } else {\r\n        this.frame = this.smallStopFrame;\r\n      }\r\n      /* this.frame = this.isBig ? this.bigStopFrame : this.smallStopFrame; */\r\n    },\r\n    jumping() {\r\n      this.stop();\r\n      if (this.isBig) {\r\n        this.frame = this.bigJumpFrame;\r\n      } else if (this.isFlamy) {\r\n        this.frame = this.flameJumpFrame;\r\n      } else {\r\n        this.frame = this.smallJumpFrame;\r\n      }\r\n      /* this.frame = this.isBig ? this.bigJumpFrame : this.smallJumpFrame; */\r\n    },\r\n    shooting() {\r\n      this.stop();\r\n      if (this.isFlamy) {\r\n        this.frame = this.flameShotFrame;\r\n      }\r\n    },\r\n    running() {\r\n      let animation;\r\n      if (this.isBig) {\r\n        animation = this.bigAnimation;\r\n      } else if (this.isFlamy) {\r\n        animation = this.flameanimation;\r\n      } else {\r\n        animation = this.smallAnimation;\r\n      }\r\n      /* const animation = this.isBig ? this.bigAnimation : this.smallAnimation; */\r\n      if (this.curAnim() !== animation) {\r\n        this.play(animation);\r\n      }\r\n    },\r\n    freeze() {\r\n      this.isFrozen = true;\r\n    },\r\n    die() {\r\n      /* this.stop();\r\n      this.frame = this.smallDieFrame; */\r\n      this.unuse(\"body\");\r\n      this.bump();\r\n      this.isAlive = false;\r\n      this.freeze();\r\n      this.use(lifespan(6, { fade: 1 }));\r\n      play(\"gameover\", {\r\n        volume: 0.2,\r\n        detune: rand(-100, 0),\r\n      });\r\n    },\r\n  };\r\n}\r\n"]}